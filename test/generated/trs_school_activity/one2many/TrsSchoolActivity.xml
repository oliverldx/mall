<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.macro.mall.dao.TrsSchoolActivityDao">

    <resultMap id="TrsSchoolActivityDto" type="com.macro.mall.dto.TrsSchoolActivityDto" extends="com.macro.mall.mapper.TrsSchoolActivityMapper.BaseResultMap">
                <result column="school_name" jdbcType="VARCHAR" property="schoolName" />
    </resultMap>

    <select id="getList" resultMap="TrsSchoolActivityDto">
        SELECT trs_school_activity.id,trs_school.name school_name,trs_school_activity.trs_activity_id,trs_school_activity.course_num,trs_school_activity.sort
	 FROM trs_school_activity as trs_school_activity
	 LEFT JOIN trs_school as trs_school ON trs_school_activity.trs_school_id = trs_school.id
	 LEFT JOIN trs_activity as trs_activity ON trs_school_activity.trs_activity_id = trs_activity.id

	where 
		trs_school_activity.trs_activity_id=#{queryParam.trsActivityId}
    </select>

    <resultMap id="TrsSchoolActivitySubListQueryParam" type="com.macro.mall.dto.TrsSchoolActivitySubListQueryParam">
                <result column="id" jdbcType="BIGINT" property="id" />
                <result column="logo" jdbcType="VARCHAR" property="logo" />
                <result column="name" jdbcType="VARCHAR" property="name" />
                <result column="contact_name" jdbcType="VARCHAR" property="contactName" />
    </resultMap>

    <select id="getSchoolList" resultMap="TrsSchoolActivitySubListQueryParam">
        SELECT trs_school.id,trs_school.logo,trs_school.name,trs_school.contact_name
	 FROM 
	trs_school as trs_school
	 LEFT JOIN trs_school_activity as trs_school_activity ON trs_school.id = trs_school_activity.trs_school_id

	 WHERE 
	trs_school_activity.id IS NULL
	<if test="queryParam.id!=null">
	 and trs_school.id = #{queryParam.id}
	</if>
	<if test="queryParam.logo!=null">
	 and trs_school.logo = #{queryParam.logo}
	</if>
	<if test="queryParam.name!=null">
	 and trs_school.name = #{queryParam.name}
	</if>
	<if test="queryParam.contactName!=null">
	 and trs_school.contact_name = #{queryParam.contactName}
	</if>
    </select>
</mapper>