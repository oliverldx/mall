<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.macro.mall.portal.dao.PortalActivitiesDao">

    <resultMap id="ActivitiesMap" type="com.macro.mall.portal.domain.Activities" autoMapping="true">
        <result column="id" jdbcType="VARCHAR" property="id" />
        <result column="pic" jdbcType="VARCHAR" property="pic" />
        <result column="name" jdbcType="VARCHAR" property="name" />
        <collection property="activitySchoolList" columnPrefix="sch_" resultMap="activitySchoolMap">
        </collection>
        <collection property="activityCourseList" columnPrefix="crs_" resultMap="activityCourseMap">
        </collection>
    </resultMap>

    <resultMap id="activityCourseMap" type="com.macro.mall.portal.domain.Activities$ActivityCourse">
        <result column="id" jdbcType="VARCHAR" property="id" />
        <result column="name" jdbcType="VARCHAR" property="name" />
        <result column="pic" jdbcType="VARCHAR" property="pic" />
    </resultMap>

    <resultMap id="activitySchoolMap" type="com.macro.mall.portal.domain.Activities$ActivitySchool">
        <result column="id" jdbcType="VARCHAR" property="id" />
        <result column="name" jdbcType="VARCHAR" property="name" />
        <result column="pic" jdbcType="VARCHAR" property="pic" />
    </resultMap>

    <select id="getActivities" resultMap="ActivitiesMap">
        SELECT trs_activity.id,
                trs_activity.logo pic ,
                trs_activity.name,
                trs_school.id sch_id,
                trs_school.`name` sch_name,
                trs_school.logo sch_pic,
                trs_course.id crs_id,
                trs_course.pic crs_pic,
                trs_course.`name` crs_name
        FROM trs_activity as trs_activity
                 LEFT JOIN trs_course_activity as trs_course_activity ON trs_activity.id = trs_course_activity.trs_activity_id
                 LEFT JOIN trs_course as trs_course ON trs_course_activity.trs_course_id = trs_course.id
                 LEFT JOIN trs_school_activity as trs_school_activity ON trs_activity.id = trs_school_activity.trs_activity_id
                 LEFT JOIN trs_school as trs_school ON trs_school_activity.trs_school_id = trs_school.id
        where trs_activity.id = #{id}
    </select>



</mapper>