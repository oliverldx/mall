<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.macro.mall.dao.TrsCourseActivityDao">

    <resultMap id="TrsCourseActivityDto" type="com.macro.mall.dto.TrsCourseActivityDto" extends="com.macro.mall.mapper.TrsCourseActivityMapper.BaseResultMap">
                <result column="course_name" jdbcType="VARCHAR" property="courseName" />
    </resultMap>

    <select id="getList" resultMap="TrsCourseActivityDto">
        SELECT trs_course_activity.id,trs_course.name course_name,trs_course_activity.course_num,trs_course_activity.apply_num,trs_course_activity.sort
	 FROM trs_course_activity as trs_course_activity
	 LEFT JOIN trs_course as trs_course ON trs_course_activity.trs_course_id = trs_course.id
	 LEFT JOIN trs_activity as trs_activity ON trs_course_activity.trs_activity_id = trs_activity.id

	where 
		trs_course_activity.trs_activity_id=#{queryParam.trsActivityId}
    </select>

    <resultMap id="TrsCourseActivitySubListQueryParam" type="com.macro.mall.dto.TrsCourseActivitySubListQueryParam">
                <result column="id" jdbcType="BIGINT" property="id" />
                <result column="pic" jdbcType="VARCHAR" property="pic" />
                <result column="name" jdbcType="VARCHAR" property="name" />
                <result column="price" jdbcType="DECIMAL" property="price" />
    </resultMap>

    <select id="getCourseList" resultMap="TrsCourseActivitySubListQueryParam">
        SELECT trs_course.id,trs_course.pic,trs_course.name,trs_course.price
	 FROM 
	trs_course as trs_course
	 LEFT JOIN trs_course_activity as trs_course_activity ON trs_course.id = trs_course_activity.trs_course_id

	 WHERE 
	trs_course_activity.id IS NULL
	<if test="queryParam.id!=null">
	 and trs_course.id = #{queryParam.id}
	</if>
	<if test="queryParam.pic!=null">
	 and trs_course.pic = #{queryParam.pic}
	</if>
	<if test="queryParam.name!=null">
	 and trs_course.name = #{queryParam.name}
	</if>
	<if test="queryParam.price!=null">
	 and trs_course.price = #{queryParam.price}
	</if>
    </select>
</mapper>